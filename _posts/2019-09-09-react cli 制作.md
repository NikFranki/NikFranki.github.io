---
layout:     post
title:      "react cli åˆ¶ä½œ"
subtitle:   ""
date:       2019-09-09
author:     "franki"
header-img: "images/post-bg-js-module.jpg"
catalog: true
tags:
    - å‰ç«¯å‘½ä»¤è¡Œ
    - cli
---

## react cli

å†™åœ¨å‰é¢ï¼Œä¸€ä¸ªä¸æƒ³é€ è½®å­çš„æ¬ç –å·¥ä¸æ˜¯å¥½çš„ç¨‹åºæ±ªï¼

---

## ä¸€ ä¸ºä»€ä¹ˆä¼šæœ‰é€  react cli çš„æƒ³æ³•

å—å›°äºæ¯æ¬¡æ–°å¼€é¡¹ç›®ï¼Œä¸è®ºé¡¹ç›®å¤§å°ï¼Œéƒ½å¾—é‡æ–°æ­å»ºï¼Œæ— ç–‘æ˜¯åŠ³æ°‘ä¼¤è´¢ã€æ•ˆç‡ä½ä¸‹çš„è‹¦å·®äº‹ã€‚

æƒ³åˆ°å½“å‰æµè¡Œçš„æ¡†æ¶`react`ã€`vue`ã€`angular`éƒ½æœ‰å„è‡ªçš„`cli`ï¼Œè™½ç„¶ä»¥ä¸Šçš„`cli`ï¼Œè¶³ä»¥è§£å†³å¸‚é¢ä¸Šå¤§éƒ¨åˆ†åœºæ™¯é—®é¢˜ï¼Œä½†æ˜¯ç”±äºå…¬å¸å†…éƒ¨é¡¹ç›®çš„ç‰¹æ®Šæ€§ï¼Œéœ€è¦æ›´å¤šä¸ªæ€§åŒ–çš„é…ç½®ï¼Œæ•…æœ‰äº†åš`react cli`çš„å†³å®šã€‚

---

## äºŒ è¦è§£å†³çš„é—®é¢˜

* æ”¯æŒreact
* æ”¯æŒreactã€react-router
* æ”¯æŒreactã€react-redux
* æ”¯æŒreactã€react-routerã€react-redux
* æ”¯æŒreactã€react-routerã€react-reduxã€typescript
* æ”¯æŒreact-hooks(å¾…å®š)

---

## ä¸‰ æœ€ç»ˆè¦å®Œæˆçš„å½¢æ€

1. æ‰€æœ‰å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§æ‰“åŒ…çš„æŒ‡ä»¤é›†ä¸­å°è£…åœ¨ä¸€ä¸ªå…¨å±€å˜é‡é‡Œé¢ï¼Œç±»ä¼¼äº`react-scripts`ï¼Œæ‰§è¡Œ`react-scripts start`ï¼Œå°±å¯ä»¥å¯åŠ¨é¡¹ç›®è¿›è¡Œå¼€å‘ï¼›æ‰§è¡Œ`react-scripts test`ï¼Œå°±å¯ä»¥è¿›è¡Œä»£ç æµ‹è¯•ç­‰ç­‰ï¼›

2. æ”¯æŒä¸åŒçš„éœ€æ±‚çš„é¡¹ç›®ï¼Œæ¯ä¸ªéœ€æ±‚éƒ½å¯¹åº”çš„é…ç½®æ¨¡æ¿ï¼Œæ”¾ç½®åœ¨ä¸åŒçš„ç›®å½•ä¸­ã€‚

3. å…¨å±€å®‰è£…æŒ‡ä»¤ä¸­ï¼Œå¯ä»¥æŒ‡å®šå®‰è£…å¯¹åº”çš„æ¨¡æ¿ï¼Œå‡çº§å¯¹åº”çš„æ¨¡æ¿ã€‚

---

## å›› å¦‚ä½•å¼€å§‹

å…ˆæ”¾ä¸ªå¤§æ‹›ï¼Œshowå‡ºæ•´ä¸ªé¡¹ç›®çš„ç›®å½•ç»“æ„ï¼ŒçŒœçŒœå„è‡ªçš„åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼ŸğŸ˜
![catalogue](/images/posts/cli/catalogue.png)

### 1. å‡†å¤‡å¥½æ¨¡æ¿æ–‡ä»¶

ç›®å‰æä¾›äº†ä¸¤å¥—æ¨¡æ¿ï¼Œä¸€å¥—æ˜¯çº¯ `react`ï¼ˆä¸åŒ…æ‹¬`router`ã€`redux`ã€`typescript`ï¼‰ï¼Œä¸€å¥—æ˜¯æ•´åˆäº† `react` å…¨å®¶æ¡¶ + `typescript`ï¼ˆå³æ˜¯ `react`+`react-router`+`react-redux`+`typescript`ï¼‰,ä¸»è¦æ”¾ç½®åœ¨ `template` ç›®å½•ä¸­ï¼Œå‰è€…æ˜¯ `default` é¡¹ç›®ï¼Œåè€…æ˜¯ `typescript` é¡¹ç›®ã€‚

### 2. å®Œæˆcliè„šæœ¬

åœ¨å®Œæˆ `cli` è„šæœ¬å‰ï¼Œéœ€è¦çŸ¥é“ä»€ä¹ˆæ˜¯ `cli` ï¼Ÿ
Wikipediaç»™å‡ºçš„è§£é‡Šæ˜¯è¿™æ ·æ»´
> å‘½ä»¤è¡Œç•Œé¢ï¼ˆè‹±è¯­ï¼šCommand-Line Interfaceï¼Œç¼©å†™ï¼šCLIï¼‰æ˜¯åœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢å¾—åˆ°æ™®åŠä¹‹å‰ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„ç”¨æˆ·ç•Œé¢ï¼Œå®ƒé€šå¸¸ä¸æ”¯æŒé¼ æ ‡ï¼Œç”¨æˆ·é€šè¿‡é”®ç›˜è¾“å…¥æŒ‡ä»¤ï¼Œè®¡ç®—æœºæ¥æ”¶åˆ°æŒ‡ä»¤åï¼Œäºˆä»¥æ‰§è¡Œã€‚ä¹Ÿæœ‰äººç§°ä¹‹ä¸ºå­—ç¬¦ç”¨æˆ·ç•Œé¢ï¼ˆcharacter user interface, CUIï¼‰ã€‚

è¯´äººè¯å°±æ˜¯å¯¹ç€é‚£ä¸ªé»‘é»‘çš„çª—å£ï¼ˆç»ˆç«¯ï¼‰æ•²å‘½ä»¤ï¼Œç„¶åè¾“å‡ºä½ æƒ³è¦çš„ä¸œè¥¿ï¼Œä»…æ­¤è€Œå·²ã€‚

æ—©æœŸçš„è®¡ç®—æœºä¹Ÿå°±å¦‚æ­¤ï¼Œåªä¸è¿‡ä¸ºäº†æ™®é€šäººéƒ½èƒ½è½»æ¾ä½¿ç”¨å®ƒï¼Œä¾¿æœ‰äº†GUIï¼Œåšçš„æœ€å¥½çš„è«è¿‡äºç°åœ¨çš„windowsï¼Œå“ˆå“ˆï¼Œæ‰¯è¿œäº†ã€‚ã€‚ã€‚

å¥½æˆå¼€åœºäº†

å¦‚ä½•è®©é¡¹ç›®æˆä¸ºå¯æ‰§è¡Œï¼Ÿ

å…³é”®éƒ¨åˆ† `package.json` ç»™å‡ºç­”æ¡ˆï¼Œéœ€è¦åœ¨è¯¥æ–‡ä»¶ä¸­æŒ‡å®š`bin`é€‰é¡¹ï¼Œè¿™æ ·å°±å¯ä»¥åšåˆ°å†…éƒ¨å‘½ä»¤æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ï¼Œæ˜¯ä¸æ˜¯å¾ˆç¥å¥‡ã€‚

åœ¨`package.json`é‡Œé¢æ·»åŠ 

```bash
"bin": {
        "start-react-project": "index.js"
},
```

å¦‚ä½•åšåˆ°æŒ‰æç¤ºå®‰è£…æƒ³è¦çš„æ¨¡æ¿ï¼Ÿ

é¦–å…ˆè§£é‡Šä¸‹ï¼Œ`package.json`å°†ä¼šå®‰è£…ä»¥ä¸‹çš„ä¾èµ–

"chalk" - æ§åˆ¶å°å­—ç¬¦æ ·å¼
"commander" - æ¥æ”¶å‘½ä»¤å‚æ•°è¾“å…¥
"conf" - æŒä¹…åŒ–æ’ä»¶
"cp-file" - æ‹·è´æ–‡ä»¶
"execa" - è°ƒç”¨shellå’Œæœ¬åœ°å¤–éƒ¨ç¨‹åºçš„javascriptå°è£… å¯åŠ¨å­è¿›ç¨‹
"globby" - åŒ¹é…æ–‡ä»¶ç›®å½•
"handlebars" - æ¨¡æ¿è§£æ
"inquirer" - æç¤ºè¾“å…¥
"make-dir" - æ–‡ä»¶å¤¹åˆ›å»º
"ora" - å‘½ä»¤è¡Œloading
"p-each-series" - è¿­ä»£å™¨

---

åœ¨`package.json`è®¾ç½®çš„`bin`é€‰é¡¹æŒ‡å®šåˆ°`index.js`,

`index.js` çš„å†…å®¹ä¸º

```bash
#!/usr/bin/env node
'use strict';

require('./lib/cli');
```

---

cli.js æ–‡ä»¶ä¸»è¦åšçš„äº‹æƒ…æœ‰ï¼š

* [ ] æ¥æ”¶å‘½ä»¤è¡Œå‚æ•°
* [ ] å¤„ç†å‘½ä»¤è¡Œå‚æ•°
* [ ] å¤„ç†æç¤ºå‚æ•°
* [ ] åˆ›å»ºç›®æ ‡æ–‡ä»¶å¤¹åŠå…¶æ–‡ä»¶

å…¶ä¸­ç¬¬ä¸‰ç‚¹ä¸»è¦é€šè¿‡ [prompt-params.js](https://github.com/NikFranki/start-react-project/blob/master/lib/default-params.js) å»åš
ç¬¬å››ç‚¹äº¤ç”± [create-project.js](https://github.com/NikFranki/start-react-project/blob/master/lib/create-project.js) å»åš

npm link (å‘å¸ƒåç”¨npm i -g start-react-project)

åšå®Œä»¥ä¸Šéƒ¨åˆ†ï¼Œå¯ä»¥åœ¨å½“å‰ç›®å½•ï¼Œæ‰§è¡Œ `npm link`, npm link ä½œç”¨:

> åœ¨æœ¬åœ°å¼€å‘ npm æ¨¡å—çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ npm link å‘½ä»¤ï¼Œå°† npm æ¨¡å—é“¾æ¥åˆ°å¯¹åº”çš„è¿è¡Œé¡¹ç›®ä¸­å»ï¼Œæ–¹ä¾¿åœ°å¯¹æ¨¡å—è¿›è¡Œè°ƒè¯•å’Œæµ‹è¯•

åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…¶æ¥éªŒè¯ cli åŠŸèƒ½çš„å®Œæ•´æ€§ã€‚

æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œ`start-react-project`ï¼Œè¾“å…¥ç›¸å…³ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°
![prompt](/images/posts/cli/prompt.png)

æ‰§è¡Œ

```bash
cd && yarn start
```

å°±å¯ä»¥çœ‹åˆ°é¡¹ç›®è¿è¡Œèµ·æ¥äº†

### 3. clié¡¹ç›®å‘å¸ƒåˆ°npm

    åœ¨ `package.json` è®¾ç½®
    ```
    "main": "index.js"
    ```
    
    æ‰§è¡Œ
    ```
    npm publish
    ```
    
    `npm` å‘å¸ƒç›¸å…³æ•™ç¨‹ï¼Œå¯ä»¥çœ‹æˆ‘ä¹‹å‰å‘å¸ƒçš„æ–‡ç« 
    [npm åŒ…åˆ¶ä½œå‘å¸ƒ](http://franki.sevenyuan.cn/2018/10/npm%E5%8C%85%E5%88%B6%E4%BD%9C%E5%8F%91%E5%B8%83%E5%88%9D%E4%BD%93%E9%AA%8C/)

## æ€»ç»“

`cli` åˆ¶ä½œå¤§è‡´æµç¨‹å°±æ˜¯*å‡†å¤‡æ¨¡æ¿-ç¼–å†™è„šæœ¬-å‘å¸ƒ*ï¼Œå…·ä½“ä½¿ç”¨å‚è€ƒ[start-react-project](https://github.com/NikFranki/start-react-project)
